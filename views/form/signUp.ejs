<!DOCTYPE html>
<html lang="fr">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge"> 
        <link rel="shortcut icon" type="image/png" href="/images/favicon.png"/>
        <!-- my custom Bootstrap -->
        <link href="/css/style.css" rel="stylesheet">

    <title>Nourrir Aline - Connexion</title>
  </head>
  <body>
    
    <div class="cover-container d-flex flex-column">
      <!-- Header Navbar-->
      <%- include('../header')%>
      

      <div class="container-fluid">
        <div class="row">
          <div class="col-12 col-md-10 offset-md-1 col-lg-8 offset-lg-2 col-xl-6 offset-xl-3">
            <div class="card">
              <div class="card-body">
                
                <h1 class="title text-primary h1 mt-2 mb-4">S'enregistrer</h1>

                <% if (locals.alert != undefined) {%>
                  <div class="row">
                    <div class="col-12">
                      <div class="alert alert-danger" role="alert">
                        <% if (locals.alert == 'user-exist') {%>
                          Un utilisateur avec cet email est déjà enregistré.
                        <% } %>
                        <% if (locals.alert == 'network-exist') {%>
                          Une entreprise avec ce nom est déjà enregistré.
                        <% } %>
                        <% if (locals.alert == 'passwords-unmatch') {%>
                          Les mots de passe doivent être identiques.
                        <% } %>
                        <% if (locals.alert == 'alert') {%>
                          Ooops, quelque chose s'est mal passé...
                        <% } %>
                      </div>
                    </div>
                  </div>
                <% } %>


              <form action="/network/sign-up" method="POST" oninput='passwordConfirmedFromFront.setCustomValidity(passwordConfirmedFromFront.value != passwordFromFront.value ? "Les mots de passe doivent être identiques." : "")'>

                <!-- PERSO -->
                <fieldset class="">
                  <legend>Vos infos</legend>
                  <div class="form-group">
                    <label for="exampleInputFirstname">Votre prénom <span class="text-danger">*</span></label>
                    <input name="firstnameFromFront" type="text" class="form-control" placeholder="ex : Alain" required />
                  </div>

                  <div class="form-group">
                    <label for="exampleInputLastname">Votre nom <span class="text-danger">*</span></label>
                    <input name="lastnameFromFront" type="text" class="form-control" placeholder="ex : Wang" required />
                  </div>

                  <div class="form-group">
                    <label for="exampleInputEmail1">Votre e-mail <span class="text-danger">*</span></label>
                    <input name="emailFromFront" type="email" class="form-control" aria-describedby="emailHelp" placeholder="ex : exemple@email.com" required />
                  </div>

                  <div class="form-group">
                    <label for="exampleInputPassword1">Choisissez un mot de passe <span class="text-danger">*</span></label>
                    <input name="passwordFromFront" type="password" class="form-control"  placeholder="votre mot de passe" required />
                  </div>

                  <div class="form-group">
                    <label for="exampleInputPassword1">Confirmez votre mot de passe <span class="text-danger">*</span></label>
                    <input name="passwordConfirmedFromFront" type="password" class="form-control"  placeholder="confirmez votre mot de passe" required />
                  </div>
                </fieldset>
                <!-- END PERSO -->

                <!-- NETWORK INFO -->
                <fieldset class="">
                  <legend>Votre réseau de consigne</legend>
                  <div class="form-group">
                    <label for="exampleInputBusinessname">Nom de l'entreprise <span class="text-danger">*</span></label>
                    <input name="businessnameFromFront" type="text" class="form-control" placeholder="ex : looper" required />
                  </div>
  
                  <!-- logo   -->
                  <div class="form-group">
                    <div id='myImage'><img src="https://res.cloudinary.com/alineconsigne/image/upload/v1597671122/website/placeholder-image_eoeppy.png" height="100" alt="Votre logo"></div>
                    <label for="">Logo de l'entreprise</label><br />
                    <a id="upload_widget" class="btn btn-sm btn-outline-primary">Séléctionner une photo</a>
                    <input id="imgurl" name="imageFromFront" type="hidden" class="form-control" value="" />
                  </div>                  
  
                  <div class="form-group">
                    <label for="exampleInputPhone">Téléphone <span class="text-danger">*</span></label>
                    <input name="phoneFromFront" type="text" class="form-control" placeholder="ex : +33145424941" required />
                  </div>
  
  
                    <div class="form-group">
                      <label for="exampleInputAdress">Adresse <span class="text-danger">*</span></label>
                      <input name="adressFromFront" type="text" class="form-control" placeholder="ex : 121 rue Réaumur" required />
                    </div>
  
                    <div class="form-group">
                      <label for="exampleInputZipcode">Code postal <span class="text-danger">*</span></label>
                      <input name="zipcodeFromFront" type="text" class="form-control" placeholder="ex : 75002" required />
                    </div>
  
                    <div class="form-group">
                      <label for="exampleInputCity">Ville <span class="text-danger">*</span></label>
                      <input name="cityFromFront" type="text" class="form-control" placeholder="ex : Paris" required />
                    </div>
  
                    <div class="form-group">
                      <label for="exampleInputWebsite">Site internet</label>
                      <input name="websiteFromFront" type="text" class="form-control" placeholder="ex : http://exemple.com" />
                    </div>
  
                    <div class="form-group">
                      <label for="refoundtypeFromFront">Type de consigne <span class="text-danger">*</span></label>
                      <select class="form-control custom-select" id="refoundtypeFromFront" name="refoundtypeFromFront" required>
                        <option selected disabled value>Choisissez dans la liste...</option>
                        <option>Bouteilles en verre</option>
                        <option>Boîtes repas</option>
                        <option>Bocaux en verre</option>
                        <option>Mug café</option>
                        <option>Autre</option>
                      </select>
                    </div>
  
                    <div class="form-group">
                      <label for="exampleInputZoneaction">Zone d'action <span class="text-danger">*</span></label>
                      <input name="zoneactionFromFront" type="text" class="form-control" placeholder="ex : Agglomération bordelaise" required />
                    </div>
                </fieldset>
                <!-- END NETWORK INFO -->
                
                  <p class="text-center"><button type="submit" class="btn btn-primary">Inscrire le réseau</button></p>

                  
               </form>
               <hr class="my-4">
            
               <p class="text-center text-center mt-4 mb-2">On se connait déjà ?</p>
               <p class="text-center"><a href="/sign-in" class="btn btn-outline-primary text-center">Se connecter</a></p>
           </div>
         </div>
       </div>
     </div>
   </div>

   <%- include('../footer')%>
 </div>

    <!-- Cloudinary widget -->
    <script src="https://widget.cloudinary.com/v2.0/global/all.js" type="text/javascript"></script>  
    <script type="text/javascript">  
      var myWidget = cloudinary.createUploadWidget({
        cloudName: 'alineconsigne', 
        uploadPreset: 'ml_default',
        multiple: false, // multiples autorisés
        maxFiles: 1, // nombe max de photo
        folder: 'networks-logos', // folder
        }, (error, result) => { 
          if (!error && result && result.event === "success") { 
            console.log('Done! Here is the image info: ', result.info); 
            var secureUrl = result.info.secure_url
            console.log(secureUrl)
            var myImage = document.getElementById("myImage")
            myImage.innerHTML = `<img src="${result.info.thumbnail_url}" alt="${result.info.public_id}">`
            document.getElementById("imgurl").value = result.info.secure_url
            // ----- this is how result.info looks like ------
            // access_mode: "public"
            // asset_id: "ba97cd4dec2a75cd0228871cafe6f791"
            // batchId: "uw-batch2"
            // bytes: 68197
            // created_at: "2020-08-11T14:54:38Z"
            // etag: "7aab44a855cdc03a5b839d146b64c3b8"
            // existing: false
            // format: "png"
            // height: 426
            // id: "uw-file3"
            // original_filename: "Nom_Photo_"
            // path: "v1597157678/Nom_Photo__zenlkt.png"
            // placeholder: false
            // public_id: "Nom_Photo__zenlkt"
            // resource_type: "image"
            // secure_url: "https://res.cloudinary.com/alineconsigne/image/upload/v1597157678/Nom_Photo_zenlkt.png"
            // signature: "52828f9ac7d3ab714856fd6e3d9143c9fc51c36e"
            // tags: []
            // thumbnail_url: "https://res.cloudinary.com/alineconsigne/image/upload/c_limit,h_60,w_90/v1597157678/Nom_Photo__zenlkt.png"
            // type: "upload"
            // url: "http://res.cloudinary.com/alineconsigne/image/upload/v1597157678/Nom_Photo_zenlkt.png"
            // version: 1597157678
            // version_id: "1b5b9fa91ac89d4dd60793b1f3345d6d"
            // width: 1244
          }
        }
      )
      document.getElementById("upload_widget").addEventListener("click", function(){
          myWidget.open();
        }, false);
    </script>


      
  <!-- BOOTSTRAP -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
  </body>
</html>

